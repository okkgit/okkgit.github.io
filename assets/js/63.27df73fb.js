(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{336:function(t,a,s){"use strict";s.r(a);var n=s(14),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"go程序编译过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go程序编译过程"}},[t._v("#")]),t._v(" go程序编译过程")]),t._v(" "),a("ul",[a("li",[t._v("编译\n"),a("ul",[a("li",[t._v("文本到文件")])])]),t._v(" "),a("li",[t._v("链接")])]),t._v(" "),a("p",[t._v("linux可执行文件")]),t._v(" "),a("ul",[a("li",[t._v("ELF header")]),t._v(" "),a("li",[t._v("Sectuib header")]),t._v(" "),a("li",[t._v("Sesctions")])]),t._v(" "),a("h1",{attrs:{id:"go进程的启动与初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#go进程的启动与初始化"}},[t._v("#")]),t._v(" go进程的启动与初始化")]),t._v(" "),a("p",[t._v("golang是一种有runtime的语言，runtime的组成")]),t._v(" "),a("ol",[a("li",[t._v("Scheduelr GMP后台执行的调度循环")]),t._v(" "),a("li",[t._v("Netpoll 网络相关时间的读写等")]),t._v(" "),a("li",[t._v("Memory 内存分配")]),t._v(" "),a("li",[t._v("Garbage 回收垃圾内存")])]),t._v(" "),a("ul",[a("li",[t._v("entry point找到程序入口")])]),t._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("go")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("func")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("这段代码其实是想runtime提交了一个计算任务")]),t._v(" "),a("ul",[a("li",[t._v("调度流程本身就是一个生产-消费流程")]),t._v(" "),a("li",[t._v("各类线程执行执行调度循环（尝试获取任务）")]),t._v(" "),a("li",[t._v("空闲的线程，进入空闲线程队列，没有可用线程进空闲线程里面找")])]),t._v(" "),a("h2",{attrs:{id:"生产端逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#生产端逻辑"}},[t._v("#")]),t._v(" 生产端逻辑")]),t._v(" "),a("p",[t._v("队列(优先级 高中低)")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("runnext, 每个p上一个，局部性原理(长度为1队列)")])]),t._v(" "),a("li",[a("p",[t._v("local run queue（类数组， max is 256）")])]),t._v(" "),a("li",[a("p",[t._v("golobal run queue（链表，大小无线）")])]),t._v(" "),a("li",[a("p",[t._v("goroutine创建步骤")]),t._v(" "),a("ul",[a("li",[t._v("分配内存等。。。。")]),t._v(" "),a("li",[t._v("插入到队列\n"),a("ul",[a("li",[t._v("放到runnext，非空后续执行")]),t._v(" "),a("li",[t._v("如果runnext有值，将其踢给local")]),t._v(" "),a("li",[t._v("如果local满，拿走local一半外加被踢走的G,放到global队列")])])])])])]),t._v(" "),a("h2",{attrs:{id:"消费端逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#消费端逻辑"}},[t._v("#")]),t._v(" 消费端逻辑")]),t._v(" "),a("ul",[a("li",[t._v("多个线程反复执行一个循环从队列里免拿值\n"),a("ul",[a("li",[t._v("schedule-> runtime.execute -> runtime.gogo -> runtime.goexit -><")])])])])])}),[],!1,null,null,null);a.default=e.exports}}]);